# ComfyUI My Combined Nodes (Grsai & Utility Suite)

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ ComfyUI è‡ªå®šä¹‰èŠ‚ç‚¹åˆé›†ï¼ŒåŒ…å«å›¾åƒç”Ÿæˆï¼ˆGrsai/Evolink APIï¼‰ã€è§†è§‰å¤§æ¨¡å‹ï¼ˆGeminiï¼‰ã€ä»¥åŠå¤šç§å®ç”¨çš„é€»è¾‘å¤„ç†å’Œå›¾åƒå¤„ç†å·¥å…·ã€‚

This custom node suite includes Image Generation (Grsai/Evolink), Vision LLM (Gemini), and various utility nodes for workflow automation.

## ğŸ“¥ å®‰è£…æ–¹æ³• (Installation)

1. è¿›å…¥ ComfyUI çš„ `custom_nodes` ç›®å½•ã€‚
2. æ‰“å¼€ç»ˆç«¯ (CMD) è¿è¡Œï¼š
   ```bash
   git clone https://github.com/wanjin123111/ComfyUI_My_Combined_Nodes.git
   ```
3. é‡å¯ ComfyUIã€‚
4. (å¯é€‰) å®‰è£…ä¾èµ–ï¼š`pip install -r requirements.txt`

---

## ğŸ§© èŠ‚ç‚¹åˆ—è¡¨ä¸åŠŸèƒ½è¯¦è§£ (Node Descriptions)

### 1. ğŸŒ Grsai Nano Banana (Pro/Fast + Local)
**åŠŸèƒ½**ï¼šæ ¸å¿ƒå›¾åƒç”ŸæˆèŠ‚ç‚¹ã€‚æ”¯æŒé€šè¿‡ Grsai æˆ– Evolink API åœ¨çº¿ç”Ÿæˆå›¾åƒï¼Œä¹Ÿæ”¯æŒè¯»å–æœ¬åœ°æ–‡ä»¶å¤¹å›¾ç‰‡åºåˆ—ã€‚
- **è¾“å…¥ (Inputs)**:
  - `provider`: æœåŠ¡æä¾›å•† (Grsai / Evolink / Local Sequence)ã€‚
  - `grsai_model`: é€‰æ‹©æ¨¡å‹ (å¦‚ nano-banana-pro, flux-pro-1.1 ç­‰)ã€‚
  - `prompt`: æç¤ºè¯ã€‚
  - `resolution`: åˆ†è¾¨ç‡ (1K/2K/4K)ã€‚
  - `image_1` - `image_5`: å›¾ç”Ÿå›¾å‚è€ƒå›¾ã€‚
  - `api_key`: API å¯†é’¥ (æ”¯æŒç¯å¢ƒå˜é‡æˆ–ç›´æ¥è¾“å…¥)ã€‚
- **è¾“å‡º (Outputs)**:
  - `image`: ç”Ÿæˆçš„å›¾åƒã€‚
  - `status`: ä»»åŠ¡çŠ¶æ€æ–‡æœ¬ã€‚
  - `failed`: å¤±è´¥è®¡æ•° (0/1)ã€‚

### 2. Apiqik/Gemini Vision (Clean Output)
**åŠŸèƒ½**ï¼šè°ƒç”¨ Google Gemini è§†è§‰å¤§æ¨¡å‹ï¼Œå¯¹å›¾åƒè¿›è¡Œåæ¨ã€åˆ†ææˆ–ç”Ÿæˆæ–‡æœ¬æè¿°ã€‚
- **è¾“å…¥ (Inputs)**:
  - `api_key`: Gemini/Apiqik API å¯†é’¥ã€‚
  - `prompt`: æ–‡æœ¬æç¤ºè¯ (å¦‚ "æè¿°è¿™å¼ å›¾")ã€‚
  - `platform`: æ¥å£å¹³å°é€‰æ‹© (Grsai, Evolink, ChatAI ç­‰)ã€‚
  - `image_1` - `image_5`: è¾“å…¥å›¾åƒ (æ”¯æŒå¤šå›¾åˆ†æ)ã€‚
- **è¾“å‡º (Outputs)**:
  - `text`: å¤§æ¨¡å‹è¿”å›çš„æ–‡æœ¬ç»“æœ (å·²æ¸…æ´—æ€ç»´é“¾æ ‡ç­¾)ã€‚

### 3. Storyboard Counter (åˆ†é•œè®¡æ•°å™¨)
**åŠŸèƒ½**ï¼šä¸“ä¸ºåˆ†é•œè„šæœ¬è®¾è®¡çš„è®¡æ•°å™¨ï¼Œæ”¯æŒä¸­æ–‡æ•°å­—è‡ªåŠ¨é€’å¢ (å¦‚ "åˆ†é•œä¸€", "åˆ†é•œäºŒ")ã€‚
- **è¾“å…¥ (Inputs)**:
  - `trigger`: åŒ…å«åˆ†é•œè¯çš„æç¤ºè¯å­—ç¬¦ä¸²ã€‚
  - `prefix`: å‰ç¼€ (é»˜è®¤ä¸º "åˆ†é•œ")ã€‚
  - `reset`: æ˜¯å¦é‡ç½®è®¡æ•°ã€‚
- **è¾“å‡º (Outputs)**:
  - `text`: å½“å‰çš„åˆ†é•œæ ‡ç­¾ (å¦‚ "åˆ†é•œä¸‰")ã€‚
  - `original_text`: åŸå§‹è¾“å…¥çš„æç¤ºè¯ã€‚

### 4. Smart Image Concatenate (æ™ºèƒ½å›¾åƒæ‹¼æ¥)
**åŠŸèƒ½**ï¼šæ™ºèƒ½æ‹¼æ¥å¤šå¼ å›¾åƒï¼Œæ”¯æŒè‡ªåŠ¨ç»Ÿä¸€é«˜åº¦/å®½åº¦ï¼Œé¿å…æ‹¼æ¥é”™ä½ã€‚
- **è¾“å…¥ (Inputs)**:
  - `direction`: æ‹¼æ¥æ–¹å‘ (Right å‘å³ / Up å‘ä¸Š)ã€‚
  - `match_image_size`: æ˜¯å¦å¼ºåˆ¶åŒ¹é…ç¬¬ä¸€å¼ å›¾çš„å°ºå¯¸ã€‚
  - `output_mode`: è¾“å‡ºæ¨¡å¼ (æ‹¼æ¥æ‰€æœ‰ / éšæœºè¾“å‡ºä¸€å¼ )ã€‚
  - `image_1` - `image_10`: æœ€å¤šæ”¯æŒ 10 å¼ å›¾è¾“å…¥ã€‚
- **è¾“å‡º (Outputs)**:
  - `image`: æ‹¼æ¥åçš„ç»“æœå›¾ã€‚

### 5. Role Keyword Detector (è§’è‰²å…³é”®è¯è¯†åˆ«)
**åŠŸèƒ½**ï¼šæ£€æµ‹é•¿æ–‡æœ¬ä¸­æ˜¯å¦åŒ…å«ç‰¹å®šçš„è§’è‰²æ ‡ç­¾ (å¦‚ "å›¾ä¸€è§’è‰²")ï¼Œç”¨äºå·¥ä½œæµé€»è¾‘åˆ¤æ–­ã€‚
- **è¾“å…¥ (Inputs)**:
  - `text_input`: éœ€è¦æ£€æµ‹çš„é•¿æ–‡æœ¬ã€‚
  - `target_keyword`: ç›®æ ‡å…³é”®è¯ã€‚
- **è¾“å‡º (Outputs)**:
  - `signal_int`: ä¿¡å·å€¼ (1 è¡¨ç¤ºå­˜åœ¨ï¼Œ0 è¡¨ç¤ºä¸å­˜åœ¨)ã€‚
  - `passthrough_text`: åŸå§‹æ–‡æœ¬é€ä¼ ã€‚

### 6. Scene Keyword Detector (åœºæ™¯å…³é”®è¯è¯†åˆ«)
**åŠŸèƒ½**ï¼šæ£€æµ‹é•¿æ–‡æœ¬ä¸­æ˜¯å¦åŒ…å«ç‰¹å®šçš„åœºæ™¯æ ‡ç­¾ (å¦‚ "å›¾ä¸€åœºæ™¯")ï¼ŒåŠŸèƒ½åŒä¸Šã€‚
- **è¾“å…¥ (Inputs)**:
  - `target_keyword`: ç›®æ ‡åœºæ™¯å…³é”®è¯ã€‚
- **è¾“å‡º (Outputs)**:
  - `signal_int`: ä¿¡å·å€¼ (1/0)ã€‚

### 7. Aspect Ratio (æ¯”ä¾‹é€‰æ‹©å™¨)
**åŠŸèƒ½**ï¼šæ ¹æ®å¸¸ç”¨æ¯”ä¾‹ (16:9, 9:16 ç­‰) å’ŒåŸºç¡€åˆ†è¾¨ç‡ï¼Œè‡ªåŠ¨è®¡ç®—æœ€ä½³çš„å®½å’Œé«˜ã€‚
- **è¾“å…¥ (Inputs)**:
  - `aspect_ratio`: é¢„è®¾æ¯”ä¾‹ã€‚
  - `base_resolution`: åŸºç¡€åƒç´ è¾¹é•¿ (å¦‚ 1024)ã€‚
- **è¾“å‡º (Outputs)**:
  - `size_string`: åˆ†è¾¨ç‡å­—ç¬¦ä¸² (å¦‚ "1024x1024")ã€‚
  - `ratio_cat`: æ¯”ä¾‹ç±»åˆ«å­—ç¬¦ä¸²ã€‚

### 8. Batch Integer Gen (æŒ‰è¡Œæ•´æ•°ç”Ÿæˆå™¨)
**åŠŸèƒ½**ï¼šç”Ÿæˆä¸€ç³»åˆ—è¿ç»­çš„æ•´æ•°ï¼Œå¸¸ç”¨äºåˆ†é¡µè¯»å–æˆ–æ‰¹é‡å¤„ç†æ—¶çš„ç´¢å¼•ç”Ÿæˆã€‚
- **è¾“å…¥ (Inputs)**:
  - `index`: å½“å‰é¡µç /ç´¢å¼•ã€‚
  - `batch_size`: æ¯æ‰¹ç”Ÿæˆçš„æ•°é‡ã€‚
- **è¾“å‡º (Outputs)**:
  - `int_list`: æ•´æ•°åˆ—è¡¨ (List[Int])ã€‚
  - `debug_string`: è°ƒè¯•ä¿¡æ¯ã€‚

### 9. ğŸ”§ Safe Image From Batch
**åŠŸèƒ½**ï¼šå®‰å…¨åœ°ä»å›¾åƒæ‰¹æ¬¡(Batch)ä¸­åˆ‡ç‰‡æå–å›¾åƒã€‚å¦‚æœè¾“å…¥ä¸ºç©ºæˆ–ç´¢å¼•è¶Šç•Œï¼Œä¼šè‡ªåŠ¨è¿”å›ä¸€å¼ çº¯é»‘ç©ºå›¾ï¼Œé˜²æ­¢å·¥ä½œæµæŠ¥é”™ã€‚
- **è¾“å…¥ (Inputs)**:
  - `image`: è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡ã€‚
  - `start`: èµ·å§‹ç´¢å¼•ã€‚
  - `length`: æå–æ•°é‡ã€‚
- **è¾“å‡º (Outputs)**:
  - `image`: æå–å‡ºçš„å›¾åƒã€‚

### 10. ğŸŒ Grsai Provider Selector
**åŠŸèƒ½**ï¼šç®€å•çš„æ–‡æœ¬é€‰æ‹©å™¨ï¼Œç”¨äºå¿«é€Ÿåˆ‡æ¢ GrsaiNanoBanana èŠ‚ç‚¹çš„è¿è¡Œæ¨¡å¼ã€‚
- **é€‰é¡¹**: Grsai / Evolink / Local Sequenceã€‚

---

## âš ï¸ å…è´£å£°æ˜
æœ¬æ’ä»¶ä»…ä½œä¸º ComfyUI çš„æ‰©å±•å·¥å…·ï¼Œè°ƒç”¨ç¬¬ä¸‰æ–¹ API (å¦‚ Grsai, Evolink, Gemini) äº§ç”Ÿçš„è´¹ç”¨å’Œå†…å®¹ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…ã€‚è¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ä½¿ç”¨ã€‚